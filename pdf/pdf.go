package pdf

import (
	"io"

	"github.com/go-pdf/fpdf"
)

// constants & variables ******************************************************************************************************************
// ****************************************************************************************************************************************
// ****************************************************************************************************************************************

// public functions ***********************************************************************************************************************
// ****************************************************************************************************************************************
// ****************************************************************************************************************************************

// Init
// ****************************************************************************************************************************************
func Init(pages []PageOption, cells []CellOption) (out PDF, err error) {
	ctx := &context{
		fpdf: fpdf.New("", "", "", "/"),
		pageOptions: append([]option{
			PageMarginsOption(10, 10, 10, 10, true),
		}, pages...),
		cellOptions: append([]option{
			BorderColorOption("#000000"),
			CellMarginsOption(2),
			CellHeightOption(0),
			CellWidthOption(1),
			CellAlignOption(AlignML),
			CellBorderOption(""),
			FontFamilyOption("Arial"),
			FontSizeOption(11),
			PositionNewLineOption(),
			TextColorOption("#000000"),
		}, cells...),
	}

	return ctx, nil
}

// type defineds **************************************************************************************************************************
// ****************************************************************************************************************************************
// ****************************************************************************************************************************************

// PDF
// ****************************************************************************************************************************************
type PDF interface {
	AddPage(...option) PDF
	AddBarcode128(string, ...option) PDF
	AddCell(text string, opts ...option) PDF
	AddDisplay(label, content string, opts ...option) PDF
	AddLink(txt, url string, opts ...option) PDF

	GetXY() (float64, float64)

	Output(io.Writer) error
	Close() error
}
