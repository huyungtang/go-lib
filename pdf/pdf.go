package pdf

import (
	"io"

	"github.com/go-pdf/fpdf"
)

// constants & variables ******************************************************************************************************************
// ****************************************************************************************************************************************
// ****************************************************************************************************************************************

// public functions ***********************************************************************************************************************
// ****************************************************************************************************************************************
// ****************************************************************************************************************************************

// Init
// ****************************************************************************************************************************************
func Init(pages []PageOption, cells []CellOption) (out PDF, err error) {
	ctx := &context{
		fpdf: fpdf.New("", "", "", "/"),
		pageOptions: append([]option{
			PageMarginsOption(10, 10, 10, 10, true),
		}, pages...),
		cellOptions: append([]option{
			BorderColorOption("#000000"),
			MarginsOption(2),
			HeightOption(0),
			WidthOption(1),
			AlignOption(AlignML),
			BorderOption(""),
			FontFamilyOption("Arial"),
			FontSizeOption(11),
			PositionNewLineOption(),
			TextColorOption("#000000"),
		}, cells...),
	}

	return ctx, nil
}

// type defineds **************************************************************************************************************************
// ****************************************************************************************************************************************
// ****************************************************************************************************************************************

// PDF
// ****************************************************************************************************************************************
type PDF interface {
	AddPage(...option) PDF
	AddBarcode128(string, ...option) PDF
	AddCell(text string, opts ...option) PDF
	AddRow(dtos []*PDFRowDTO) PDF
	AddLink(txt, url string, opts ...option) PDF

	GetXY() (float64, float64)
	SetXY(float64, float64) PDF
	GetContainerSize() (float64, float64)

	Output(io.Writer) error
	Close() error
}

// PDFRowDTO
// ****************************************************************************************************************************************
type PDFRowDTO struct {
	Text string
	Opts []CellOption
}
